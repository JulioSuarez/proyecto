import{a as _,c as p}from"./news_eventos-2235123c.js";console.log("hola desde ia_mover_cara.js");let v=document.getElementById("butom_ia");const h="dmlsbWVjYXN0b0BndWZ1bS5jb20:XkqeCy4ddaOBlfaTBOh38";let m="";async function y(){try{let e=videos.length;console.log("cc="+e);let t=document.querySelector('input[name="animacion"]:checked'),i=document.querySelector('input[name="voces"]:checked'),c=document.getElementById("ip_mensaje"),a="es-MX-GerardoNeural";i.value==0&&(a="es-MX-DaliaNeural"),console.log("voz: ",a);const s={script:{type:"text",input:c.value,provider:{type:"microsoft",voice_id:a,voice_config:{style:"Cheerful"}}},config:{stitch:!0,driver_expressions:{expressions:[{start_frame:0,expression:t.value,intensity:1}]}},source_url:m};_(e);let d=document.getElementById("img_contendio"+e),l=document.getElementById("img_imagen"+e),n=document.getElementById("model_video"+e);await fetch("https://api.d-id.com/talks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+h},body:JSON.stringify(s)}).then(r=>r.json()).then(async r=>{console.log(r),d.textContent="Procesando video...";let u=r.id;console.log("id_video:",u);let g="procesando";for(;g!=="done";)console.log(),await new Promise(o=>setTimeout(o,5e3)),await fetch("https://api.d-id.com/talks/"+u,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+h}}).then(o=>o.json()).then(o=>{console.log("respuesta:",o),g=o.status,o.status=="done"?(videos.push(o.result_url),d.textContent="Listo para reproducir"+e,l.src=o.source_url,n.src=o.result_url,f(e,o.result_url,c.value,i.value,t.value),p()):o.status=="error"?console.error("ERROR mostrar mensaje de error"):console.warn("EL VIDEO SIGUE EN PROCESO")});console.log("termine de cargar")}).catch(r=>{console.log("entre al error:",r)}),console.log("fin xd xd")}catch(e){console.error("Error al realizar el POST:",e)}}v.addEventListener("click",async function(){let e=document.getElementById("ip_mensaje"),t=document.getElementById("ip_error");e.value.length<3||m==""?m==""?t.textContent="*selecciona un avatar":t.textContent="*minimum 3 characters":(t.textContent="",y())});const f=async(e,t,i,c,a)=>{console.log("subiendo video a la base de datos");let s=document.querySelector('meta[name="csrf-token"]').getAttribute("content");console.log("token: ",s);let d=document.querySelector('input[name="avatar"]:checked');try{const l={message:i,expression:a,gender:c,route_path:t,sort:e,avatar_id:d.value,program_id:$programa_id,_token:s};await fetch("/new/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(n=>n.json()).then(n=>{if(console.warn("response:",n),n.status=="success"){let r=document.getElementById("credits");r.textContent=n.credits,console.log("Creditos actualizados")}}).catch(n=>{console.log("entre al error:",n)}),console.log("fin xd xd")}catch(l){console.error("Error al realizar el POST:",l)}};for(let e=0;e<$len_avatars;e++){let t=document.getElementById("img_avatar"+e);t.addEventListener("click",function(){document.getElementById("foto_seleccionada").src=t.src,m=t.src})}
