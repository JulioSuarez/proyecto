import{a as v,c as y}from"./news_eventos-eb75720c.js";console.log("hola desde ia_mover_cara.js");let p=document.getElementById("butom_ia");const h="Z3Vwc296aXJ6aUBndWZ1bS5jb20:w4_0MAT0MFC7jHh7AQCVb";let m="";async function f(){try{let e=videos.length;console.log("cc="+e);let t=document.querySelector('input[name="animacion"]:checked'),a=document.querySelector('input[name="voces"]:checked'),c=document.getElementById("ip_mensaje"),i="es-MX-GerardoNeural";a.value==0&&(i="es-MX-DaliaNeural"),console.log("voz: ",i);const s={script:{type:"text",input:c.value,provider:{type:"microsoft",voice_id:i,voice_config:{style:"Cheerful"}}},config:{stitch:!0,driver_expressions:{expressions:[{start_frame:0,expression:t.value,intensity:1}]}},source_url:m};v(e);let d=document.getElementById("img_contendio"+e),l=document.getElementById("img_imagen"+e),r=document.getElementById("model_video"+e);await fetch("https://api.d-id.com/talks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+h},body:JSON.stringify(s)}).then(o=>o.json()).then(async o=>{if(console.log(o),d.textContent="Procesando video...",console.log("response.kind: ",o.kind),console.log("response.status: ",o.status),o.kind=="CelebrityDetectedError")Swal.fire({icon:"error",title:"Celebrity Detected ",text:"Recognized a celebrity in the provided image - if you have the image rights you can contact suppor"}),document.getElementById("div"+videos.length).remove();else{let u=o.id;console.log("id_video:",u);let g="procesando";for(;g!=="done";)console.log(),await new Promise(n=>setTimeout(n,5e3)),await fetch("https://api.d-id.com/talks/"+u,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+h}}).then(n=>n.json()).then(n=>{console.log("respuesta:",n),g=n.status,n.status=="done"?(videos.push(n.result_url),d.textContent="Listo para reproducir",l.src=n.source_url,r.src=n.result_url,_(e,n.result_url,c.value,a.value,t.value),y()):n.status=="error"?console.error("ERROR mostrar mensaje de error"):(console.warn("EL VIDEO SIGUE EN PROCESO"),console.log(o))})}console.log("termine de cargar")}).catch(o=>{console.log("entre al error:",o)}),console.log("fin xd xd")}catch(e){console.error("Error al realizar el POST:",e)}}p.addEventListener("click",async function(){let e=document.getElementById("ip_mensaje"),t=document.getElementById("ip_error"),a=document.getElementById("credits");a.textContent<=0||e.value.length<3||m==""?(a.textContent<=0&&(t.textContent="*you have no credits",Swal.fire({icon:"error",title:"Oops...",text:"ya no tienes creditos para crear un video",footer:'<a href="http://127.0.0.1:8000/store"> Ir a comprar </a>'})),m==""&&(t.textContent="*selecciona un avatar",Swal.fire({icon:"error",title:"Oops...",text:"Seelcciona un avatar",footer:'<a href="#">Why do I have this issue?</a>'})),e.value.length<3&&(t.textContent="*minimum 3 characters",Swal.fire({icon:"error",title:"Oops...",text:"Debes escribir un texto de minimo 3 caracteres"}))):(t.textContent="",f())});const _=async(e,t,a,c,i)=>{console.log("subiendo video a la base de datos");let s=document.querySelector('meta[name="csrf-token"]').getAttribute("content");console.log("token: ",s);let d=document.querySelector('input[name="avatar"]:checked');try{const l={message:a,expression:i,gender:c,route_path:t,sort:e,avatar_id:d.value,program_id:$programa_id,_token:s};await fetch("/new/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(r=>r.json()).then(r=>{if(console.warn("response:",r),console.log("hola esyt en subir video "),r.message=="success"){let o=document.getElementById("credits");o.textContent=r.credits,console.log("Creditos actualizados")}else console.log("Ã©sty en else xd ")}).catch(r=>{console.log("entre al error al subri video :",r)}),console.log("fin xd xd")}catch(l){console.error("Error al realizar el POST:",l)}};for(let e=0;e<$len_avatars;e++){let t=document.getElementById("img_avatar"+e);t.addEventListener("click",function(){document.getElementById("foto_seleccionada").src=t.src,m=t.src})}
